{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.2", "generated_at": "2024-06-11T22:25:19.580955Z", "invocation_id": "c23bc199-ff0b-4079-9fe3-eec54d8021b7", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-11T22:25:13.752273Z", "completed_at": "2024-06-11T22:25:13.789884Z"}, {"name": "execute", "started_at": "2024-06-11T22:25:13.790405Z", "completed_at": "2024-06-11T22:25:15.316947Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5689802169799805, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "airflow-dbt-426117", "job_id": "107477ac-7c7a-4cdb-9a47-63c1488dd40b", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.retail.dim_customer", "compiled": true, "compiled_code": "-- dim_customer.sql\n\n-- Create the dimension table\nWITH customer_cte AS (\n\tSELECT DISTINCT\n\t    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,\n\t    Country AS country\n\tFROM `airflow-dbt-426117`.`retail`.`raw_invoices`\n\tWHERE CustomerID IS NOT NULL\n)\nSELECT\n    t.*,\n\tcm.iso\nFROM customer_cte t\nLEFT JOIN `airflow-dbt-426117`.`retail`.`country` cm ON t.country = cm.nicename", "relation_name": "`airflow-dbt-426117`.`retail`.`dim_customer`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-11T22:25:15.322341Z", "completed_at": "2024-06-11T22:25:15.325835Z"}, {"name": "execute", "started_at": "2024-06-11T22:25:15.326417Z", "completed_at": "2024-06-11T22:25:16.607351Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2862260341644287, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "airflow-dbt-426117", "job_id": "7e136bce-96a3-4750-958a-e990321b796f", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.retail.dim_datetime", "compiled": true, "compiled_code": "-- dim_datetime.sql\n\n-- Create a CTE to extract date and time components\nWITH datetime_cte AS (  \n  SELECT DISTINCT\n    InvoiceDate AS datetime_id,\n    CASE\n      WHEN LENGTH(InvoiceDate) = 16 THEN\n        -- Date format: \"DD/MM/YYYY HH:MM\"\n        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)\n      WHEN LENGTH(InvoiceDate) <= 14 THEN\n        -- Date format: \"MM/DD/YY HH:MM\"\n        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)\n      ELSE\n        NULL\n    END AS date_part,\n  FROM `airflow-dbt-426117`.`retail`.`raw_invoices`\n  WHERE InvoiceDate IS NOT NULL\n)\nSELECT\n  datetime_id,\n  date_part as datetime,\n  EXTRACT(YEAR FROM date_part) AS year,\n  EXTRACT(MONTH FROM date_part) AS month,\n  EXTRACT(DAY FROM date_part) AS day,\n  EXTRACT(HOUR FROM date_part) AS hour,\n  EXTRACT(MINUTE FROM date_part) AS minute,\n  EXTRACT(DAYOFWEEK FROM date_part) AS weekday\nFROM datetime_cte", "relation_name": "`airflow-dbt-426117`.`retail`.`dim_datetime`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-11T22:25:16.618254Z", "completed_at": "2024-06-11T22:25:16.631896Z"}, {"name": "execute", "started_at": "2024-06-11T22:25:16.633149Z", "completed_at": "2024-06-11T22:25:18.040069Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.424936056137085, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "airflow-dbt-426117", "job_id": "fda468dc-8e24-4936-bdba-5980c8a32d34", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.retail.dim_product", "compiled": true, "compiled_code": "-- dim_product.sql\n-- StockCode isn't unique, a product with the same id can have different and prices\n-- Create the dimension table\nSELECT DISTINCT\n    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,\n\t\tStockCode AS stock_code,\n    Description AS description,\n    UnitPrice AS price\nFROM `airflow-dbt-426117`.`retail`.`raw_invoices`\nWHERE StockCode IS NOT NULL\nAND UnitPrice > 0", "relation_name": "`airflow-dbt-426117`.`retail`.`dim_product`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-11T22:25:18.048736Z", "completed_at": "2024-06-11T22:25:18.064278Z"}, {"name": "execute", "started_at": "2024-06-11T22:25:18.065653Z", "completed_at": "2024-06-11T22:25:19.572623Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5250608921051025, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "airflow-dbt-426117", "job_id": "74e63f79-521e-4379-a12d-61ce54ec357a", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.retail.fct_invoices", "compiled": true, "compiled_code": "-- fct_invoices.sql\n\n-- Create the fact table by joining the relevant keys from dimension table\nWITH fct_invoices_cte AS (\n    SELECT\n        InvoiceNo AS invoice_id,\n        InvoiceDate AS datetime_id,\n        to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,\n        to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,\n        Quantity AS quantity,\n        Quantity * UnitPrice AS total\n    FROM `airflow-dbt-426117`.`retail`.`raw_invoices`\n    WHERE Quantity > 0\n)\nSELECT\n    invoice_id,\n    dt.datetime_id,\n    dp.product_id,\n    dc.customer_id,\n    quantity,\n    total\nFROM fct_invoices_cte fi\nINNER JOIN `airflow-dbt-426117`.`retail`.`dim_datetime` dt ON fi.datetime_id = dt.datetime_id\nINNER JOIN `airflow-dbt-426117`.`retail`.`dim_product` dp ON fi.product_id = dp.product_id\nINNER JOIN `airflow-dbt-426117`.`retail`.`dim_customer` dc ON fi.customer_id = dc.customer_id", "relation_name": "`airflow-dbt-426117`.`retail`.`fct_invoices`"}], "elapsed_time": 6.816073894500732, "args": {"project_dir": "/home/cyril/Documents/vscode_project/dbt_bigquery/dbt", "empty": false, "send_anonymous_usage_stats": true, "log_format_file": "debug", "profiles_dir": "/home/cyril/Documents/vscode_project/dbt_bigquery/dbt", "log_file_max_bytes": 10485760, "exclude": [], "indirect_selection": "eager", "log_level_file": "debug", "enable_legacy_logger": false, "warn_error_options": {"include": [], "exclude": []}, "macro_debugging": false, "show_resource_report": false, "populate_cache": true, "quiet": false, "which": "run", "cache_selected_only": false, "strict_mode": false, "introspect": true, "log_format": "default", "log_level": "info", "log_path": "/home/cyril/Documents/vscode_project/dbt_bigquery/dbt/logs", "defer": false, "partial_parse_file_diff": true, "print": true, "use_colors": true, "version_check": true, "static_parser": true, "vars": {}, "invocation_command": "dbt run", "use_colors_file": true, "select": [], "source_freshness_run_project_hooks": false, "write_json": true, "require_explicit_package_overrides_for_builtin_materializations": true, "require_resource_names_without_spaces": false, "favor_state": false, "printer_width": 80, "partial_parse": true}}