{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.2", "generated_at": "2024-06-14T10:18:09.564002Z", "invocation_id": "a0db8233-4dec-4aa6-b3e2-b64a536576a4", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-14T10:18:09.457406Z", "completed_at": "2024-06-14T10:18:09.491081Z"}, {"name": "execute", "started_at": "2024-06-14T10:18:09.491894Z", "completed_at": "2024-06-14T10:18:09.491926Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03592038154602051, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.retail.dim_customer", "compiled": true, "compiled_code": "-- dim_customer.sql\n\n-- Create the dimension table\nWITH customer_cte AS (\n\tSELECT DISTINCT\n\t    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,\n\t    Country AS country\n\tFROM `airflow-dbt-426117`.`retail`.`raw_invoices`\n\tWHERE CustomerID IS NOT NULL\n)\nSELECT\n    t.*,\n\tcm.iso\nFROM customer_cte t\nLEFT JOIN `airflow-dbt-426117`.`retail`.`country` cm ON t.country = cm.nicename", "relation_name": "`airflow-dbt-426117`.`retail`.`dim_customer`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-14T10:18:09.496263Z", "completed_at": "2024-06-14T10:18:09.501250Z"}, {"name": "execute", "started_at": "2024-06-14T10:18:09.501960Z", "completed_at": "2024-06-14T10:18:09.501975Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007669925689697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.retail.dim_datetime", "compiled": true, "compiled_code": "-- dim_datetime.sql\n\n-- Create a CTE to extract date and time components\nWITH datetime_cte AS (  \n  SELECT DISTINCT\n    InvoiceDate AS datetime_id,\n    CASE\n      WHEN LENGTH(InvoiceDate) = 16 THEN\n        -- Date format: \"DD/MM/YYYY HH:MM\"\n        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)\n      WHEN LENGTH(InvoiceDate) <= 14 THEN\n        -- Date format: \"MM/DD/YY HH:MM\"\n        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)\n      ELSE\n        NULL\n    END AS date_part,\n  FROM `airflow-dbt-426117`.`retail`.`raw_invoices`\n  WHERE InvoiceDate IS NOT NULL\n)\nSELECT\n  datetime_id,\n  date_part as datetime,\n  EXTRACT(YEAR FROM date_part) AS year,\n  EXTRACT(MONTH FROM date_part) AS month,\n  EXTRACT(DAY FROM date_part) AS day,\n  EXTRACT(HOUR FROM date_part) AS hour,\n  EXTRACT(MINUTE FROM date_part) AS minute,\n  EXTRACT(DAYOFWEEK FROM date_part) AS weekday\nFROM datetime_cte", "relation_name": "`airflow-dbt-426117`.`retail`.`dim_datetime`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-14T10:18:09.506155Z", "completed_at": "2024-06-14T10:18:09.516759Z"}, {"name": "execute", "started_at": "2024-06-14T10:18:09.517918Z", "completed_at": "2024-06-14T10:18:09.517942Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013648271560668945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.retail.dim_product", "compiled": true, "compiled_code": "-- dim_product.sql\n-- StockCode isn't unique, a product with the same id can have different and prices\n-- Create the dimension table\nSELECT DISTINCT\n    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,\n\t\tStockCode AS stock_code,\n    Description AS description,\n    UnitPrice AS price\nFROM `airflow-dbt-426117`.`retail`.`raw_invoices`\nWHERE StockCode IS NOT NULL\nAND UnitPrice > 0", "relation_name": "`airflow-dbt-426117`.`retail`.`dim_product`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-14T10:18:09.522405Z", "completed_at": "2024-06-14T10:18:09.533148Z"}, {"name": "execute", "started_at": "2024-06-14T10:18:09.533756Z", "completed_at": "2024-06-14T10:18:09.533768Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012817621231079102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.retail.fct_invoices", "compiled": true, "compiled_code": "-- fct_invoices.sql\n\n-- Create the fact table by joining the relevant keys from dimension table\nWITH fct_invoices_cte AS (\n    SELECT\n        InvoiceNo AS invoice_id,\n        InvoiceDate AS datetime_id,\n        to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,\n        to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,\n        Quantity AS quantity,\n        Quantity * UnitPrice AS total\n    FROM `airflow-dbt-426117`.`retail`.`raw_invoices`\n    WHERE Quantity > 0\n)\nSELECT\n    invoice_id,\n    dt.datetime_id,\n    dp.product_id,\n    dc.customer_id,\n    quantity,\n    total\nFROM fct_invoices_cte fi\nINNER JOIN `airflow-dbt-426117`.`retail`.`dim_datetime` dt ON fi.datetime_id = dt.datetime_id\nINNER JOIN `airflow-dbt-426117`.`retail`.`dim_product` dp ON fi.product_id = dp.product_id\nINNER JOIN `airflow-dbt-426117`.`retail`.`dim_customer` dc ON fi.customer_id = dc.customer_id", "relation_name": "`airflow-dbt-426117`.`retail`.`fct_invoices`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-14T10:18:09.537139Z", "completed_at": "2024-06-14T10:18:09.542006Z"}, {"name": "execute", "started_at": "2024-06-14T10:18:09.542667Z", "completed_at": "2024-06-14T10:18:09.542680Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006918907165527344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.retail.report_customer_invoices", "compiled": true, "compiled_code": "-- report_customer_invoices.sql\nSELECT\n  c.country,\n  c.iso,\n  COUNT(fi.invoice_id) AS total_invoices,\n  SUM(fi.total) AS total_revenue\nFROM `airflow-dbt-426117`.`retail`.`fct_invoices` fi\nJOIN `airflow-dbt-426117`.`retail`.`dim_customer` c ON fi.customer_id = c.customer_id\nGROUP BY c.country, c.iso\nORDER BY total_revenue DESC\nLIMIT 10", "relation_name": "`airflow-dbt-426117`.`retail`.`report_customer_invoices`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-14T10:18:09.545671Z", "completed_at": "2024-06-14T10:18:09.550139Z"}, {"name": "execute", "started_at": "2024-06-14T10:18:09.550777Z", "completed_at": "2024-06-14T10:18:09.550790Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006460428237915039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.retail.report_product_invoices", "compiled": true, "compiled_code": "-- report_product_invoices.sql\nSELECT\n  p.product_id,\n  p.stock_code,\n  p.description,\n  SUM(fi.quantity) AS total_quantity_sold\nFROM `airflow-dbt-426117`.`retail`.`fct_invoices` fi\nJOIN `airflow-dbt-426117`.`retail`.`dim_product` p ON fi.product_id = p.product_id\nGROUP BY p.product_id, p.stock_code, p.description\nORDER BY total_quantity_sold DESC\nLIMIT 10", "relation_name": "`airflow-dbt-426117`.`retail`.`report_product_invoices`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-14T10:18:09.554475Z", "completed_at": "2024-06-14T10:18:09.559628Z"}, {"name": "execute", "started_at": "2024-06-14T10:18:09.560353Z", "completed_at": "2024-06-14T10:18:09.560366Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007451295852661133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.retail.report_year_invoices", "compiled": true, "compiled_code": "-- report_year_invoices.sql\nSELECT\n  dt.year,\n  dt.month,\n  COUNT(DISTINCT fi.invoice_id) AS num_invoices,\n  SUM(fi.total) AS total_revenue\nFROM `airflow-dbt-426117`.`retail`.`fct_invoices` fi\nJOIN `airflow-dbt-426117`.`retail`.`dim_datetime` dt ON fi.datetime_id = dt.datetime_id\nGROUP BY dt.year, dt.month\nORDER BY dt.year, dt.month", "relation_name": "`airflow-dbt-426117`.`retail`.`report_year_invoices`"}], "elapsed_time": 0.6392769813537598, "args": {"use_colors": true, "cache_selected_only": false, "log_format": "default", "partial_parse": true, "static_parser": true, "log_format_file": "debug", "printer_width": 80, "send_anonymous_usage_stats": true, "static": false, "enable_legacy_logger": false, "require_explicit_package_overrides_for_builtin_materializations": true, "show_resource_report": false, "empty_catalog": false, "profiles_dir": "/home/cyril/Documents/vscode_project/dbt_bigquery/dbt", "vars": {}, "strict_mode": false, "invocation_command": "dbt docs generate", "exclude": [], "compile": true, "log_level": "info", "project_dir": "/home/cyril/Documents/vscode_project/dbt_bigquery/dbt", "indirect_selection": "eager", "print": true, "use_colors_file": true, "warn_error_options": {"include": [], "exclude": []}, "version_check": true, "source_freshness_run_project_hooks": false, "log_path": "/home/cyril/Documents/vscode_project/dbt_bigquery/dbt/logs", "favor_state": false, "macro_debugging": false, "defer": false, "quiet": false, "populate_cache": true, "which": "generate", "select": [], "partial_parse_file_diff": true, "write_json": true, "require_resource_names_without_spaces": false, "introspect": true, "log_level_file": "debug", "log_file_max_bytes": 10485760}}